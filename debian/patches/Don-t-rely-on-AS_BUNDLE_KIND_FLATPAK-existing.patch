From: Simon McVittie <smcv@debian.org>
Date: Wed, 12 Jan 2022 16:01:07 +0000
Subject: Don't rely on AS_BUNDLE_KIND_FLATPAK existing

The appstream-glib in Ubuntu 16.04 didn't have this.

Signed-off-by: Simon McVittie <smcv@debian.org>
---
 app/flatpak-builtins-search.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/app/flatpak-builtins-search.c b/app/flatpak-builtins-search.c
index fc525f4..3cb65c6 100644
--- a/app/flatpak-builtins-search.c
+++ b/app/flatpak-builtins-search.c
@@ -198,6 +198,7 @@ static char *
 _app_get_id_no_suffix (AsApp *app)
 {
   const char *id_stripped = NULL;
+#if AS_CHECK_VERSION (0, 5, 15)
   GPtrArray *bundles = NULL;
 
   /* First try using the <bundle> ID which is unambiguously the flatpak ref */
@@ -213,6 +214,7 @@ _app_get_id_no_suffix (AsApp *app)
       if (decomposed != NULL)
         return flatpak_decomposed_dup_id (decomposed);
     }
+#endif
 
   /* Fall back to using the <id> field, which is required by appstream spec,
    * but make sure the .desktop suffix isn't stripped overzealously
